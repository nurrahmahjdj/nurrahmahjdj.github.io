<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>STTTTTT!!!!</title>
<meta name="color-scheme" content="dark">
<style>
  :root{
    --bg:#070607;
    --gold:#ffd700;
    --rose:#ffb6c1;
    --muted:#b8b6bd;
    --card-radius:16px;
    font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Helvetica Neue", Arial;
  }
  html,body{ height:100%; margin:0; background:linear-gradient(180deg,#040405 0%, #0b0b0f 100%); color:#efeaf0; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
  .wrap{ min-height:100vh; display:flex; align-items:center; justify-content:center; padding:18px; box-sizing:border-box; }

  /* main card */
  .card{
    width:100%; max-width:420px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:var(--card-radius); padding:18px; box-shadow: 0 12px 42px rgba(0,0,0,0.6);
    border:1px solid rgba(255,215,0,0.08); position:relative; overflow:hidden;
  }
  .glow{ position:absolute; right:-70px; top:-70px; width:220px; height:220px; background:rgba(255,182,193,0.12); border-radius:50%; filter:blur(26px); pointer-events:none; }
  h1{ text-align:center; color:var(--gold); margin:6px 0 6px; font-size:20px; letter-spacing:0.5px; }
  .sub{ text-align:center; color:var(--muted); font-size:13px; margin-bottom:12px; }

  .pizza-wrap{ display:flex; align-items:center; justify-content:center; margin:6px 0 10px; position:relative; }
  svg.pizza{ width:86%; max-width:300px; height:auto; display:block; }

  .hint{ text-align:center; color:var(--muted); font-size:13px; margin-top:8px; }

  /* candle touch area */
  .candle-btn{ touch-action:manipulation; -webkit-tap-highlight-color: rgba(255,255,255,0.06); cursor:pointer; display:inline-block; }

  .flame{ transform-origin:center bottom; animation: flame-flicker 900ms infinite; }
  @keyframes flame-flicker{
    0%{ transform:translateY(0) scaleY(1); opacity:1 }
    30%{ transform:translateY(-2px) scaleY(1.05); opacity:0.96 }
    60%{ transform:translateY(1px) scaleY(0.96); opacity:0.98 }
    100%{ transform:translateY(0) scaleY(1); opacity:1 }
  }

  /* smoke */
  .smoke-piece{ position:absolute; width:10px; height:10px; border-radius:50%; background:rgba(255,255,255,0.18); filter:blur(6px); opacity:0; pointer-events:none; }

  /* confetti layer */
  .confetti{ position:fixed; left:0; top:0; width:100%; height:100%; pointer-events:none; overflow:hidden; z-index:9999; }

  /* final modal */
  .modal-overlay{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:10010;
    background:#080808; /* opaque, not transparent */
  }
  .modal{
    width:100%; max-width:380px; background:#0b0b0b; border-radius:14px; padding:18px; box-sizing:border-box;
    border:1px solid rgba(255,215,0,0.08); box-shadow: 0 18px 60px rgba(0,0,0,0.75);
  }
  .modal h2{ margin:0 0 8px; font-size:18px; color:var(--rose); }
  .modal p{ color:#efeaf0; line-height:1.55; margin:6px 0; font-size:15px; }
  .modal .actions{ margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; }
  .btn{ display:inline-block; padding:10px 14px; border-radius:10px; background:linear-gradient(90deg,var(--gold), #ffbf00); color:#081210; font-weight:800; text-decoration:none; cursor:pointer; border:none; }
  .btn.ghost{ background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.04); }

  /* modal step indicator */
  .step-ind{ text-align:center; color:var(--muted); font-size:12px; margin-top:8px; }

  /* small devices */
  @media (max-width:420px){ h1{ font-size:18px } .modal{ padding:14px } .btn{ padding:10px 12px } }

</style>
</head>
<body>
  <div class="wrap" aria-live="polite">
    <div class="card" role="main" aria-labelledby="title">
      <div class="glow" aria-hidden="true"></div>
      <h1 id="title">Happy Birthday, Jeffs! üéâ</h1>
      <div class="sub">Ada kejutan kecil‚Äîjangan langsung ngintip. Ikuti instruksi ya.</div>

      <div class="pizza-wrap" id="pizzaZone" aria-hidden="true">
        <!-- Pizza SVG with candle group (same structure as before) -->
        <svg class="pizza" viewBox="0 0 400 350" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Pizza with candle">
          <ellipse cx="200" cy="310" rx="120" ry="14" fill="rgba(0,0,0,0.45)"/>
          <g id="pizzaBody">
            <circle cx="200" cy="200" r="140" fill="#f6c27a" />
            <circle cx="200" cy="200" r="120" fill="#ffd89a" />
            <g fill="#d9573b" stroke="#b33a2a" stroke-width="2">
              <circle cx="250" cy="170" r="18"/>
              <circle cx="220" cy="230" r="16"/>
              <circle cx="160" cy="190" r="18"/>
              <circle cx="190" cy="140" r="14"/>
              <circle cx="260" cy="210" r="12"/>
            </g>
            <g fill="#3aa76a" transform="translate(-6 -4)">
              <path d="M190 120c12 6 24 6 34 2c-7 8-19 11-31 8c-4-1-7-4-3-10z"/>
              <path d="M145 220c10 6 22 4 30-4c-9 10-23 12-34 6c-3-2-5-6 4-2z"/>
            </g>
          </g>

          <g id="candleGroup" transform="translate(200,130)">
            <g class="candle-btn" id="candleBtn" role="button" tabindex="0" aria-label="Tekan lilin untuk meniup">
              <rect x="-8" y="20" width="16" height="70" rx="4" fill="#fff1f4" stroke="#ffdfe6" stroke-width="1"/>
              <path d="M-6 28 L6 28" stroke="#ffdede" stroke-width="2" opacity="0.9"/>
              <path d="M-6 40 L6 40" stroke="#ffdede" stroke-width="2" opacity="0.9"/>
              <path d="M-6 54 L6 54" stroke="#ffdede" stroke-width="2" opacity="0.9"/>
              <g id="flameGroup" transform="translate(0,14)">
                <path class="flame" id="flameInner" d="M0 0 C6 -8 12 -16 0 -28 C-12 -16 -6 -8 0 0Z" fill="#fff8cc" />
                <path class="flame" id="flameMid" d="M0 0 C4 -6 8 -12 0 -20 C-8 -12 -4 -6 0 0Z" fill="#ffd36a" style="opacity:0.95"/>
                <path class="flame" id="flameOuter" d="M0 0 C2 -4 4 -8 0 -12 C-4 -8 -2 -4 0 0Z" fill="#ff6b6b" style="opacity:0.95"/>
              </g>
            </g>
          </g>
        </svg>
      </div>

      <div class="hint">Tip: Make a wish dulu, lalu tap lilin sekali. (Mobile-friendly)</div>
    </div>
  </div>

  <div class="confetti" id="confettiLayer" aria-hidden="true"></div>

  <!-- opaque multi-step mystery modals (4 modal steps) -->
  <div id="modal0" class="modal-overlay" aria-modal="true" role="dialog">
    <div class="modal" role="document" aria-labelledby="m0title">
      <h2 id="m0title">ssst... jangan bilang siapa-siapa</h2>
      <p>Kamu nemu link ini tapi rahasiakan ya. Ada sesuatu kecil buat kamu ‚Äî tap "Okay" kalau penasaran.</p>
      <div class="actions">
        <button class="btn" id="m0ok">Okay, I‚Äôm curious</button>
        <button class="btn ghost" id="m0no">Bentar, gimana nih?</button>
      </div>
      <div class="step-ind">Step 1 of 4</div>
    </div>
  </div>

  <div id="modal1" class="modal-overlay" aria-modal="true" role="dialog" style="display:none">
    <div class="modal" role="document" aria-labelledby="m1title">
      <h2 id="m1title">Jangan buru-buru!</h2>
      <p>Kita main tebak-tebakan singkat: kalau kamu boleh pilih satu, kamu mau pizza extra cheese atau bonus tidur siang?</p>
      <div class="actions">
        <button class="btn" id="m1a">Pizza all the way üçï</button>
        <button class="btn" id="m1b">Sleep later üò¥</button>
      </div>
      <div class="step-ind">Step 2 of 4</div>
    </div>
  </div>

  <div id="modal2" class="modal-overlay" aria-modal="true" role="dialog" style="display:none">
    <div class="modal" role="document" aria-labelledby="m2title">
      <h2 id="m2title">Hampir... hampir</h2>
      <p>Aku tahu kamu pasti suka. Janji ya, kalau kamu buka ini nanti, jangan senyum-senyum sendiri. Tap "I promise".</p>
      <div class="actions">
        <button class="btn" id="m2ok">I promise</button>
      </div>
      <div class="step-ind">Step 3 of 4</div>
    </div>
  </div>

  <div id="modal3" class="modal-overlay" aria-modal="true" role="dialog" style="display:none">
    <div class="modal" role="document" aria-labelledby="m3title">
      <h2 id="m3title">Siap?</h2>
      <p>Kalau udah siap, tap "Reveal" ‚Äî bakal ada suara kecil dan sesuatu yang manis. (Tap akan memulai musik lembut)</p>
      <div class="actions">
        <button class="btn" id="m3reveal">Reveal ‚ú®</button>
      </div>
      <div class="step-ind">Step 4 of 4</div>
    </div>
  </div>

  <!-- final message modal (after candle blow) -->
  <div id="finalModal" class="modal-overlay" aria-modal="true" role="dialog" style="display:none">
    <div class="modal" role="document" aria-labelledby="finalTitle">
      <h2 id="finalTitle">Untuk Jeffs ‚Äî Surprise!</h2>
      <p id="finalText"></p>
      <div class="actions">
        <button class="btn" id="finalClose">Close & Keep it in your heart</button>
      </div>
    </div>
  </div>

<script>
/* ---------------- Audio (WebAudio) ---------------- */
(function(){
  const AudioCtx = window.AudioContext || window.webkitAudioContext;
  let ctx = null;

  function ensureCtx(){
    if(!ctx){
      ctx = new AudioCtx();
    }
    return ctx;
  }

  function playTone(freq, type='sine', start=0, duration=0.5, gain=0.12){
    const c = ensureCtx();
    const o = c.createOscillator();
    const g = c.createGain();
    o.type = type;
    o.frequency.value = freq;
    g.gain.value = 0;
    o.connect(g);
    g.connect(c.destination);
    const now = c.currentTime + start;
    g.gain.setValueAtTime(0.0001, now);
    g.gain.exponentialRampToValueAtTime(gain, now + 0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, now + duration);
    o.start(now);
    o.stop(now + duration + 0.5);
  }

  window.pianoIntro = function(){
    ensureCtx();
    playTone(440, 'triangle', 0, 0.7, 0.08);
    playTone(554.37, 'sine', 0.12, 0.7, 0.07);
    playTone(659.25, 'sine', 0.24, 0.7, 0.06);
    playTone(880, 'sine', 0.5, 0.9, 0.03);
  }

  window.puffSound = function(){
    const c = ensureCtx();
    const bufferSize = c.sampleRate * 0.22;
    const buffer = c.createBuffer(1, bufferSize, c.sampleRate);
    const data = buffer.getChannelData(0);
    for (let i=0;i<bufferSize;i++){
      data[i] = (Math.random()*2-1) * Math.exp(-i/(bufferSize*0.02));
    }
    const src = c.createBufferSource();
    src.buffer = buffer;
    const g = c.createGain();
    g.gain.value = 0.22;
    src.connect(g);
    g.connect(c.destination);
    src.start();
    playTone(110, 'sine', 0, 0.18, 0.06);
  }
})();

/* ---------------- UI Flow & Interactions ---------------- */
(function(){
  const modals = [
    document.getElementById('modal0'),
    document.getElementById('modal1'),
    document.getElementById('modal2'),
    document.getElementById('modal3')
  ];
  const pizzaZone = document.getElementById('pizzaZone');
  const candleBtn = document.getElementById('candleBtn');
  const flameGroup = document.getElementById('flameGroup');
  const confettiLayer = document.getElementById('confettiLayer');
  const finalModal = document.getElementById('finalModal');
  const finalText = document.getElementById('finalText');
  const finalClose = document.getElementById('finalClose');

  // modal controls
  const m0ok = document.getElementById('m0ok');
  const m0no = document.getElementById('m0no');
  const m1a = document.getElementById('m1a');
  const m1b = document.getElementById('m1b');
  const m2ok = document.getElementById('m2ok');
  const m3reveal = document.getElementById('m3reveal');

  // show modal n (0..3) and hide others
  function showModal(n){
    modals.forEach((m,i)=> m.style.display = (i===n ? 'flex' : 'none'));
  }
  function hideAllModals(){ modals.forEach(m=> m.style.display='none'); }

  // start with modal 0 visible (already visible in HTML)
  // modal 0 handlers
  m0ok.addEventListener('click', function(){
    // first real user interaction -> start piano intro
    try{ window.pianoIntro(); } catch(e){}
    showModal(1);
  });
  m0no.addEventListener('click', function(){
    // playful tease: move to next modal anyway
    showModal(1);
  });

  // modal1 choices (playful)
  m1a.addEventListener('click', function(){ showModal(2); });
  m1b.addEventListener('click', function(){ showModal(2); });

  // modal2 promise
  m2ok.addEventListener('click', function(){ showModal(3); });

  // modal3 reveal -> close modals and show pizza + candle
  m3reveal.addEventListener('click', function(){
    // small piano flourish again
    try{ window.pianoIntro(); } catch(e){}
    // hide all modals and reveal pizza
    modals.forEach(m=> m.style.display='none');
    // display pizza with accessible flag
    pizzaZone.setAttribute('aria-hidden','false');
    // optionally flash a tiny glow on card
    const card = document.querySelector('.card');
    card.animate([{ boxShadow: '0 12px 42px rgba(0,0,0,0.6)' }, { boxShadow: '0 12px 52px rgba(255,215,0,0.12)' }, { boxShadow: '0 12px 42px rgba(0,0,0,0.6)' }], { duration: 700 });
  });

  // Candle interactions
  let blown = false;
  candleBtn.addEventListener('click', function(){
    if(blown) return;
    blown = true;
    // 1) puff sound
    try{ window.puffSound(); } catch(e){}
    // 2) extinguish flame
    if(flameGroup){
      flameGroup.style.transition = 'opacity 420ms ease, transform 420ms ease';
      flameGroup.style.opacity = 0;
      flameGroup.style.transform = 'translateY(6px) scale(0.95)';
    }
    // 3) smoke
    spawnSmoke();
    // 4) confetti
    spawnConfetti();
    // 5) show final message after delay
    setTimeout(showFinalMessage, 850);
  });

  // keyboard accessibility
  candleBtn.addEventListener('keydown', function(e){
    if(e.key === 'Enter' || e.key === ' '){
      e.preventDefault();
      candleBtn.click();
    }
  });

  // final message content (Indo-dominant, english slips, playful)
  function showFinalMessage(){
    const msg = [
      `HAPPY BIRTHDAY SAYANGGGG! Today you officially tambah umur haha, stay a little extra goofy, and demand morning cuddles.`,
      `You're always warm, occasionally spicy, and impossible to share.`,
      `I made a wish for more silly mornings, more inside jokes, and for you to keep being wonderfully you. Keep shining, dan aku harap hubungan kita bisa terus berkembang jadi sesuatu yang lebih sehat dan kuat. AAMIIN!`,
      `Love you, Honey‚Äîlet‚Äôs spend time (and eat pizza) after this. ‚ù§Ô∏èüéÇüçï`
    ].join('<br><br>');
    finalText.innerHTML = msg;
    finalModal.style.display = 'flex';
    finalClose.focus();
  }

  finalClose.addEventListener('click', function(e){
    e.preventDefault();
    finalModal.style.display = 'none';
  });

  // smoke spawn (visual)
  function spawnSmoke(){
    const rect = document.getElementById('pizzaZone').getBoundingClientRect();
    const baseX = rect.left + rect.width*0.5;
    const baseY = rect.top + rect.height*0.28;
    for(let i=0;i<6;i++){
      const s = document.createElement('div');
      s.className = 'smoke-piece';
      document.body.appendChild(s);
      const offsetX = (Math.random()-0.5) * 24;
      const left = baseX + offsetX;
      const top = baseY + (Math.random()*6);
      s.style.left = (left) + 'px';
      s.style.top = (top) + 'px';
      s.style.width = (8 + Math.random()*10) + 'px';
      s.style.height = (8 + Math.random()*10) + 'px';
      s.style.background = 'rgba(230,230,230,0.16)';
      s.style.animation = `smoke-up ${800 + Math.random()*900}ms ease-out forwards`;
      setTimeout(()=> s.remove(), 2200 + Math.random()*600);
    }
  }

  // confetti spawn
  function spawnConfetti(){
    const N = 28;
    const colors = ['#ff6b81','#ffd86b','#7ce0b8','#9ad0ff','#c57cff','#ffd700'];
    const w = window.innerWidth;
    const h = window.innerHeight;
    for(let i=0;i<N;i++){
      const el = document.createElement('div');
      el.className = 'piece';
      el.style.background = colors[i % colors.length];
      el.style.left = (50 + (Math.random()-0.5) * 80) + '%';
      el.style.top = (-10 + Math.random()*20) + 'px';
      el.style.width = (6 + Math.random()*10) + 'px';
      el.style.height = (8 + Math.random()*14) + 'px';
      el.style.position = 'absolute';
      el.style.opacity = '0.95';
      el.style.transform = `rotate(${Math.random()*360}deg)`;
      confettiLayer.appendChild(el);

      const dx = (Math.random()-0.5) * 300;
      const dy = (h*0.6 + Math.random()*200);
      const rot = (Math.random()>0.5?1:-1) * (360 + Math.random()*720);
      el.animate([
        { transform: `translateY(0px) rotate(0deg)`, opacity:1 },
        { transform: `translate(${dx}px, ${dy}px) rotate(${rot}deg)`, opacity:0.95 }
      ], {
        duration: 1200 + Math.random()*900,
        easing: 'cubic-bezier(.15,.9,.3,1)'
      });
      setTimeout(()=> el.remove(), 2400 + Math.random()*900);
    }
  }

  // prevent background scroll while modals visible
  const body = document.body;
  function checkModals(){
    const anyVisible = Array.from(document.querySelectorAll('.modal-overlay')).some(m=> m.style.display !== 'none');
    body.style.overflow = anyVisible ? 'hidden' : '';
  }
  // observe display changes periodically (lite)
  setInterval(checkModals, 200);

  // small hint fallback in case user waits too long on first modal
  setTimeout(()=> {
    const m0 = document.getElementById('modal0');
    if(m0 && m0.style.display !== 'none'){
      const note = document.createElement('div');
      note.style.color = 'var(--muted)';
      note.style.fontSize = '13px';
      note.style.marginTop = '8px';
      note.textContent = 'Tap "Okay, I‚Äôm curious" kalau kamu sudah nggak sabar üòâ';
      m0.querySelector('.modal').appendChild(note);
    }
  }, 9000);

})();
</script>
</body>
</html>
